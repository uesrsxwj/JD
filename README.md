# JD
JD(京东逆向爬虫)h5st 5.1.3最新版，前几天才更新
# 		某东5.12版本h5st逆向扣代码

<!--本文仅供学习交流使用，禁止用于其他用途-->

以搜索接口为例来讲解：

1.首先搜索一个关键词，进行分页抓包：

![nipaste_2025-04-30_12-52-5](.\h5st\Snipaste_2025-04-30_12-52-50.png)

跟栈就不做过多讲述了，我们直接定位到加密函数入口处：

![nipaste_2025-04-30_13-04-0](.\h5st\Snipaste_2025-04-30_13-04-04.png)

有逆向基础的应该都能看出来，这里的加密主要就是针对请求体参数的。

接着我们进入加密函数，查看主要加密逻辑：

![nipaste_2025-04-30_13-09-4](.\h5st\Snipaste_2025-04-30_13-09-41.png)

进入核心加密函数：

![nipaste_2025-04-30_13-11-3](.\h5st\Snipaste_2025-04-30_13-11-34.png)

观察函数发现所有的值都通过数组c进行传递，那么我们不妨在switch出打上日志断点，监测数组的变化：

![nipaste_2025-04-30_13-19-3](.\h5st\Snipaste_2025-04-30_13-19-36.png)

日志的最后生成了我们的h5st参数：

![nipaste_2025-04-30_13-24-1](.\h5st\Snipaste_2025-04-30_13-24-14.png)

观察参数发现，h5st可能是由多个加密函数组合而成：

向上翻看日志看到了tk和t6的生成，这就印证了我们的猜想：

![nipaste_2025-04-30_13-31-2](.\h5st\Snipaste_2025-04-30_13-31-23.png)

既然这样那就好办了，我们只需要逐个击破就好。

我们先进行获取多次日志判断哪些是定值：

发现：

933xpgiddmwwphm3;f06cc;和tk是定值（其实tk也是动态的，不过半天才会变一次，所以我们这里直接把它看做定值即可）。

现在日志上的线索就只剩t6这个大字符串了，所以我们就先从他入手：

向上查找日志，找到t6第一次出现的位置：

![nipaste_2025-04-30_13-43-2](.\h5st\Snipaste_2025-04-30_13-43-25.png)



观察日志推测，在case 71出调用函数生成了t6大字符串，找到71位置处：

![nipaste_2025-04-30_13-47-3](.\h5st\Snipaste_2025-04-30_13-47-33.png)

在两个分支处打上日志断点，看他究竟做了什么：

![nipaste_2025-04-30_13-50-5](.\h5st\Snipaste_2025-04-30_13-50-56.png)

点击函数跟进去：

![nipaste_2025-04-30_13-52-1](.\h5st\Snipaste_2025-04-30_13-52-11.png)

发现是和134一样的格式，那么我们就还是老样子，在switch出打上断点，监测数组变化。

观察日志发现133在最后一步生成了t6大字符串：

![nipaste_2025-04-30_13-56-2](.\h5st\Snipaste_2025-04-30_13-56-22.png)

看到这三步应该不难猜出，对象字符串转为init对象又转换为t6大字符串。

接下来我们就只需要关注   对象字符串转换为init对象   和   init对象转换为t6大字符串   这两个步骤所需要的函数即可。

![nipaste_2025-04-30_14-04-3](.\h5st\Snipaste_2025-04-30_14-04-34.png)

依旧是找到case 26的位置打上断点，看他做了什么：

![nipaste_2025-04-30_14-06-5](.\h5st\Snipaste_2025-04-30_14-06-55.png)

第一个函数：对象字符串转init对象。

![nipaste_2025-04-30_14-08-3](.\h5st\Snipaste_2025-04-30_14-08-39.png)



第二个函数：init转换为t6大字符串。





接下来就好办了，直接点击函数进入，将两个函数扣取，然后缺啥补啥即可，做到这里我们的t6大字符串就算是完成了。

至于对象字符串里的参数，虽然是动态的，但是设置为定值也可以请求成功，追求完美可以自己打日志断点慢慢调试，这里就不做过多赘述（其中bu3和bu6分别是head和body的子元素节点数，两个random则是由同一个函数随机生成的）。



























